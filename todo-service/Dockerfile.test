# Stage 1: Builder with dependencies
FROM python:3.9-slim as builder
WORKDIR /app
COPY requirements.txt .
RUN pip install --no-cache-dir -r requirements.txt

# Stage 2: Test runner
FROM builder as test
COPY ./todo-service/ .
CMD ["pytest", "--cov=.", "--cov-report=xml"]
